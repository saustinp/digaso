void source_streamer2d(double *s, double *s_udg, double *pg, double *udg, double *param, double time, int ng, int nc, int ncu, int nd, int ncd)
{
	double param1 = param[0];
	double param2 = param[1];
	double param3 = param[2];
	double param4 = param[3];
	double param5 = param[4];
	double param6 = param[5];
	double param7 = param[6];
	double param8 = param[7];
	double param9 = param[8];
	double param10 = param[9];
	double param11 = param[10];

	for (int i = 0; i <ng; i++) {
		double x1 = pg[0*ng+i];
		double x2 = pg[1*ng+i];
		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];
		double u8 = udg[7*ng+i];
		double u9 = udg[8*ng+i];

		double t2 = u6*u6;
		double t3 = u9*u9;
		double t4 = 1.0/3.141592653589793;
		double t5 = 1.0/param2;
		double t6 = 1.0/param3;
		double t8 = u1*1.0E+3;
		double t11 = param1*3.4075E+2;
		double t7 = t6*t6*t6;
		double t9 = t2+t3;
		double t10 = atan(t8);
		double t12 = sqrt(t9);
		double t13 = t4*t10;
		double t14 = 1.0/t12;
		double t16 = param3*t12;
		double t17 = t13+1.0/2.0;
		double t15 = t14*t14*t14;
		double t18 = t17*u1;
		double t19 = 1.0/pow(t16,1.3E+1/5.0E+1);
		double t20 = t6*t14*2.73E+7;
		double t21 = -t20;
		double t23 = t7*t15*4.3666E+26;
		double t24 = t18+3.183097800805168E-4;
		double t22 = exp(t21);
		double t25 = t23+1.1944E+6;
		double t26 = param1*t22*t25;
		double t27 = -t26;
		double t28 = t11+t27;
		double t29 = t5*t12*t19*t24*t28*x1*2.3987;
		double t30 = -t29;
		s[0*ng+i] = t30;
		s[1*ng+i] = t30;
		s[2*ng+i] = -1.0/(param1*param1)*param4*param10*t6*x1*(t18-u2*(t4*atan(u2*1.0E+3)+1.0/2.0));

	}

	for (int i = 0; i <ng; i++) {
		double x1 = pg[0*ng+i];
		double x2 = pg[1*ng+i];
		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];
		double u8 = udg[7*ng+i];
		double u9 = udg[8*ng+i];

		double t2 = u1*u1;
		double t3 = u6*u6;
		double t4 = u9*u9;
		double t5 = 1.0/3.141592653589793;
		double t6 = 1.0/(param1*param1);
		double t7 = 1.0/param2;
		double t8 = 1.0/param3;
		double t10 = u1*1.0E+3;
		double t13 = param1*3.4075E+2;
		double t9 = t8*t8*t8;
		double t11 = t3+t4;
		double t12 = atan(t10);
		double t14 = t2*1.0E+6;
		double t15 = sqrt(t11);
		double t16 = t5*t12;
		double t21 = t14+1.0;
		double t17 = 1.0/t15;
		double t20 = param3*t15;
		double t22 = t16+1.0/2.0;
		double t23 = 1.0/t21;
		double t18 = t17*t17*t17;
		double t19 = t17*t17*t17*t17*t17;
		double t24 = t22*u1;
		double t25 = 1.0/pow(t20,1.3E+1/5.0E+1);
		double t26 = 1.0/pow(t20,6.3E+1/5.0E+1);
		double t27 = t8*t17*2.73E+7;
		double t28 = t5*t10*t23;
		double t29 = -t27;
		double t31 = t22+t28;
		double t32 = t9*t18*4.3666E+26;
		double t33 = t24+3.183097800805168E-4;
		double t30 = exp(t29);
		double t34 = t32+1.1944E+6;
		double t35 = param1*t9*t19*t30*u6*1.30998E+27;
		double t36 = param1*t9*t19*t30*u9*1.30998E+27;
		double t37 = param1*t30*t34;
		double t38 = -t37;
		double t40 = t8*t18*t37*u6*2.73E+7;
		double t41 = t8*t18*t37*u9*2.73E+7;
		double t39 = t13+t38;
		double t42 = -t40;
		double t43 = -t41;
		double t44 = t35+t42;
		double t45 = t36+t43;
		double t46 = t7*t15*t25*t31*t39*x1*2.3987;
		double t47 = param3*t7*t26*t33*t39*u6*x1*6.23662E-1;
		double t48 = param3*t7*t26*t33*t39*u9*x1*6.23662E-1;
		double t50 = t7*t17*t25*t33*t39*u6*x1*2.3987;
		double t51 = t7*t17*t25*t33*t39*u9*x1*2.3987;
		double t49 = -t46;
		double t52 = -t50;
		double t53 = -t51;
		double t54 = t7*t15*t25*t33*t44*x1*2.3987;
		double t55 = t7*t15*t25*t33*t45*x1*2.3987;
		double t56 = -t54;
		double t57 = -t55;
		double t58 = t47+t52+t56;
		double t59 = t48+t53+t57;
		s_udg[0*ng+i] = t49;
		s_udg[1*ng+i] = t49;
		s_udg[2*ng+i] = -param4*param10*t6*t8*t31*x1;
		s_udg[3*ng+i] = 0.0;
		s_udg[4*ng+i] = 0.0;
		s_udg[5*ng+i] = param4*param10*t6*t8*x1*(t5*atan(u2*1.0E+3)+(t5*u2*1.0E+3)/((u2*u2)*1.0E+6+1.0)+1.0/2.0);
		s_udg[6*ng+i] = 0.0;
		s_udg[7*ng+i] = 0.0;
		s_udg[8*ng+i] = 0.0;
		s_udg[9*ng+i] = 0.0;
		s_udg[10*ng+i] = 0.0;
		s_udg[11*ng+i] = 0.0;
		s_udg[12*ng+i] = 0.0;
		s_udg[13*ng+i] = 0.0;
		s_udg[14*ng+i] = 0.0;
		s_udg[15*ng+i] = t58;
		s_udg[16*ng+i] = t58;
		s_udg[17*ng+i] = 0.0;
		s_udg[18*ng+i] = 0.0;
		s_udg[19*ng+i] = 0.0;
		s_udg[20*ng+i] = 0.0;
		s_udg[21*ng+i] = 0.0;
		s_udg[22*ng+i] = 0.0;
		s_udg[23*ng+i] = 0.0;
		s_udg[24*ng+i] = t59;
		s_udg[25*ng+i] = t59;
		s_udg[26*ng+i] = 0.0;

	}
}

void sourceonly_streamer2d(double *s, double *pg, double *udg, double *param, double time, int ng, int nc, int ncu, int nd, int ncd)
{
	double param1 = param[0];
	double param2 = param[1];
	double param3 = param[2];
	double param4 = param[3];
	double param5 = param[4];
	double param6 = param[5];
	double param7 = param[6];
	double param8 = param[7];
	double param9 = param[8];
	double param10 = param[9];
	double param11 = param[10];

	for (int i = 0; i <ng; i++) {
		double x1 = pg[0*ng+i];
		double x2 = pg[1*ng+i];
		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];
		double u8 = udg[7*ng+i];
		double u9 = udg[8*ng+i];

		double t2 = u6*u6;
		double t3 = u9*u9;
		double t4 = 1.0/3.141592653589793;
		double t5 = 1.0/param2;
		double t6 = 1.0/param3;
		double t8 = u1*1.0E+3;
		double t11 = param1*3.4075E+2;
		double t7 = t6*t6*t6;
		double t9 = t2+t3;
		double t10 = atan(t8);
		double t12 = sqrt(t9);
		double t13 = t4*t10;
		double t14 = 1.0/t12;
		double t16 = param3*t12;
		double t17 = t13+1.0/2.0;
		double t15 = t14*t14*t14;
		double t18 = t17*u1;
		double t19 = 1.0/pow(t16,1.3E+1/5.0E+1);
		double t20 = t6*t14*2.73E+7;
		double t21 = -t20;
		double t23 = t7*t15*4.3666E+26;
		double t24 = t18+3.183097800805168E-4;
		double t22 = exp(t21);
		double t25 = t23+1.1944E+6;
		double t26 = param1*t22*t25;
		double t27 = -t26;
		double t28 = t11+t27;
		double t29 = t5*t12*t19*t24*t28*x1*2.3987;
		double t30 = -t29;
		s[0*ng+i] = t30;
		s[1*ng+i] = t30;
		s[2*ng+i] = -1.0/(param1*param1)*param4*param10*t6*x1*(t18-u2*(t4*atan(u2*1.0E+3)+1.0/2.0));

	}
}

